{% load custom_filters %}

{% if page_obj %}
  {% for invoice in page_obj %}
    <tr>
      <td>
        <div class="invoice-number">
          <strong>{{ invoice.invoice_number }}</strong>
          {% if invoice.notes %}
            <br />
            <small class="text-muted">{{ invoice.notes|truncatechars:30 }}</small>
          {% endif %}
        </div>
      </td>
      <td>{{ invoice.invoice_date|date:'M j, Y' }}</td>
      <td>
        <span class="badge {% if invoice.payment_type == 'CASH' %}badge-success{% else %}badge-info{% endif %}">
          {{ invoice.get_payment_type_display }}
        </span>
      </td>
      <td class="text-right">
        <strong>{{ invoice.amount|currency }}</strong>
        {% if invoice.advance_amount > 0 or invoice.discount_amount > 0 %}
          <br />
          <small class="text-muted">
            {% if invoice.advance_amount > 0 %}Adv: {{ invoice.advance_amount|currency }}{% endif %}
            {% if invoice.discount_amount > 0 %}Dis: {{ invoice.discount_amount|currency }}{% endif %}
          </small>
        {% endif %}
      </td>
      <td class="text-right">
        <strong>{{ invoice.total_payable|currency }}</strong>
      </td>
      <td class="text-center">
        <a href="{% url 'invoice:detail' invoice.id %}" 
           class="btn-action btn-view" 
           title="View Invoice" 
           target="_blank">
          <i class="fas fa-eye"></i>
        </a>
      </td>
    </tr>
  {% endfor %}
{% else %}
  <tr>
    <td colspan="6" class="text-center" style="padding: 2rem;">
      <div class="empty-state">
        <i class="fas fa-file-invoice"></i>
        <h4>No Invoices Found</h4>
        <p>No invoices have been created for this customer yet.</p>
      </div>
    </td>
  </tr>
{% endif %}

