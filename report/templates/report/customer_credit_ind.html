<!DOCTYPE html>
{% load static %}
{% load custom_filters %}
<html lang="en">
    <head>
        <meta charset="UTF-8" />
        <meta name="viewport" content="width=device-width, initial-scale=1.0" />
        <title>{{ customer.name }} - {{ shop_details.shop_name|default:"Report" }}</title>
        <link rel="stylesheet" href="styles/A4.css"/>
    </head>
    <body>
        <div class="container">
            <!-- Header Section -->
            <div class="header-section">
                <div class="header-content">
                    <div class="shop-info">
                        {% if shop_details %}
                            {% if shop_details.shop_name %}<div class="shop-name">{{ shop_details.shop_name }}</div>{% endif %}
                            <div class="shop-details">
                                {% if shop_details.address_line_one %}<p>{{ shop_details.address_line_one }}</p>{% endif %}
                                {% if shop_details.gst_no %}
                                    <p>
                                        <strong>GST:</strong> {{ shop_details.gst_no }}
                                    </p>
                                {% endif %}
                                {% if shop_details.contact_info %}
                                    <p>
                                        <strong>Contact:</strong> {{ shop_details.contact_info }}
                                    </p>
                                {% endif %}
                            </div>
                        {% endif %}
                    </div>
                    <div class="report-info">
                        <div class="report-title">{{ customer.name }} - Credit Ledger</div>
                        <div class="report-meta">
                            <p>
                                <strong>Generated:</strong> {% now "F d, Y h:i A" %}
                            </p>
                            <p>
                                <strong>Total Records:</strong> {{ total_count }}
                            </p>
                            <p>
                                <strong>Balance Amount:</strong> {{ customer.balance_amount|currency }}
                            </p>
                        </div>
                    </div>
                </div>
            </div>
            <!-- Table Section -->
            <div class="table-container">
                <table class="data-table">
                    <thead>
                        <tr>
                            <th>ID</th>
                            <th>Date</th>
                            <th>Type</th>
                            <th>Method</th>
                            <th>Total Credit</th>
                            <th>Total Debit</th>
                            <th>Balance</th>
                        </tr>
                    </thead>
                    <tbody>
                        {% if opening_balance != 0 %}
                            <tr>
                                <td></td>
                                <td>{{ start_date|date:"M j, Y" }}</td>
                                <td colspan="4">Opening Balance</td>
                                <td>{{ opening_balance|currency }}</td>
                            </tr>
                        {% endif %}
                        {% if ledger %}
                            {% for row in ledger %}
                                <tr>
                                    <td>{{ forloop.counter }}</td>
                                    <td>{{ row.date|date:"M j, Y" }}</td>
                                    <td>{{ row.type }}</td>
                                    <td>{{ row.method }}</td>
                                    <td class="text-right">{{ row.credit|currency }}</td>
                                    <td class="text-right">{{ row.debit|currency }}</td>
                                    <td class="text-right">{{ row.balance|currency }}</td>
                                </tr>
                            {% endfor %}
                        {% else %}
                            <tr>
                                <td colspan="9" class="text-center">
                                    <p class="text-muted">No customers found matching the criteria.</p>
                                </td>
                            </tr>
                        {% endif %}
                    </tbody>
                </table>
            </div>
            <!-- Footer Section -->
            <div class="footer-section">
                <div class="total-info">
                    <p>
                        <strong>Balance Amount: {{ customer.balance_amount|currency }}</strong>
                    </p>
                </div>
                <p>This is a computer-generated report. No signature required.</p>
                <p>Generated on {% now "F d, Y \a\t h:i A" %}</p>
            </div>
        </div>
    </body>
</html>
