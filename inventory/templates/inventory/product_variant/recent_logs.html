{% load custom_filters %}
{% if page_obj %}
    {% for log in page_obj %}
        <tr>
            <td>
                <span class="text-center {% if log.transaction_type == 'SALE' %}text-danger{% elif log.transaction_type == 'STOCK_IN' %}text-success{% elif log.transaction_type == 'RETURN' %}                text-success                 {% elif log.transaction_type == 'ADJUSTMENT_IN' %}                text-info                 {% elif log.transaction_type == 'ADJUSTMENT_OUT' %}                text-warning                 {% elif log.transaction_type == 'DAMAGE' %}                text-danger                 {% else %}                text-success                {% endif %}">
                    {{ log.get_transaction_type_display }}
                </span>
            </td>
            <td>
                <span class="{% if log.quantity_change > 0 %} text-success{% else %} text-danger{% endif %}">
                    {% if log.quantity_change > 0 %}+{% endif %}
                    {{ log.quantity_change|floatformat:0 }}
                </span>
            </td>
            <td>{{ log.new_quantity|floatformat:0 }}</td>
            <td>{{ log.total_value|currency | default:"-" }}</td>
            <td>
                {% if log.supplier_invoice %}
                    <div class="invoice-info-compact">
                        <span class="invoice-number">{{ log.supplier_invoice.invoice_number }}</span>
                        <small class="secondary-text">{{ log.supplier_invoice.supplier.name|truncatechars:15 }}</small>
                    </div>
                {% else %}
                    -
                {% endif %}
            </td>
            <td>{{ log.created_by.full_name | default:"-" }}</td>
            <td>{{ log.timestamp|date:'M d, Y H:i' }}</td>
            <td>
                {% if log.notes %}
                    {% if log.invoice_item.invoice %}
                        <a href="{% url 'invoice:detail' log.invoice_item.invoice.id %}"
                           class="text-primary"
                           target="_blank">
                            <span title="{{ log.notes }}">{{ log.notes|truncatechars:20 }}</span>
                        </a>
                    {% else %}
                        <span title="{{ log.notes }}">{{ log.notes|truncatechars:20 }}</span>
                    {% endif %}
                {% else %}
                    -
                {% endif %}
            </td>
        </tr>
    {% endfor %}
{% else %}
    <tr>
        <td colspan="8" class="text-center p-3">
            <div class="empty-state">
                <i class="fas fa-boxes"></i>
                <h4>No Logs Found</h4>
                <p>No logs match your search criteria. Try adjusting your filters or add a new product.</p>
            </div>
        </td>
    </tr>
{% endif %}
