{% extends "base.html" %}
{% load static %}
{% block title %}
  Cloth Types Management
{% endblock title %}
{% block content %}
  <!-- Page Header -->
  <div class="page-header">
    <h2 class="page-title">Cloth Types Management</h2>
    <div class="page-actions">
      <a href="{% url 'inventory:cloth_create' %}" class="btn btn-primary">
        <i class="fas fa-plus"></i>
        New Cloth Type
      </a>
    </div>
  </div>
  <!-- Breadcrumb Navigation -->
  <nav class="breadcrumb breadcrumb-right">
    <a href="{% url 'inventory:cloth_home' %}" class="breadcrumb-item">Cloth Types</a>
    <span class="breadcrumb-separator">/</span>
    <span class="breadcrumb-active">All Cloth Types</span>
  </nav>
  <!-- Search and Filter Section -->
  <div class="search-filter-section">
    <form method="get" class="search-filter-form" id="searchForm">
      <div class="search-group search-expanded">
        <i class="fas fa-search search-icon"></i>
        <input type="search"
               name="search"
               class="search-input"
               placeholder="Search cloth types..."
               value="{{ search_query }}"
               id="searchInput"
               autofocus />
      </div>
      <select name="sort" class="filter-select" id="sortSelect">
        <option value="-created_at"
                {% if sort_by == '-created_at' %}selected{% endif %}>Newest First</option>
        <option value="created_at"
                {% if sort_by == 'created_at' %}selected{% endif %}>Oldest First</option>
        <option value="name" {% if sort_by == 'name' %}selected{% endif %}>Name A-Z</option>
        <option value="-name" {% if sort_by == '-name' %}selected{% endif %}>Name Z-A</option>
      </select>
      <button type="submit" class="btn btn-primary">
        <i class="fas fa-search"></i>
        Search
      </button>
    </form>
  </div>
  <!-- Data Table -->
  <div class="table-container">
    {% if cloth_types %}
      <table class="data-table">
        <thead>
          <tr>
            <th>ID</th>
            <th>Name</th>
            <th>Description</th>
            <th>Products</th>
            <th>Variants</th>
            <th>Created</th>
            <th class="text-right">Actions</th>
          </tr>
        </thead>
        <tbody>
          {% for cloth_type in cloth_types %}
            <tr>
              <td>{{ cloth_type.id }}</td>
              <td>
                <div>
                  <div class="fw-bold text-primary">{{ cloth_type.name|default:'N/A' }}</div>
                </div>
              </td>
              <td>{{ cloth_type.description|default:'No description' }}</td>
              <td>
                <span class="badge badge-primary">{{ cloth_type.products.count }}</span>
              </td>
              <td>
                <span class="badge badge-primary">{{ cloth_type.products.count }}</span>
              </td>
              <td>{{ cloth_type.created_at|date:'M d, Y' }}</td>
              <td>
                <div class="action-buttons">
                  <a href="{% url 'inventory:cloth_edit' cloth_type.id %}"
                     class="btn-action btn-edit"
                     title="Edit Cloth Type"><i class="fas fa-edit"></i></a>
                  <a href="{% url 'inventory:cloth_delete' cloth_type.id %}"
                     class="btn-action btn-delete"
                     title="Delete Cloth Type"><i class="fas fa-trash"></i></a>
                </div>
              </td>
            </tr>
          {% endfor %}
        </tbody>
      </table>
    {% else %}
      <div class="empty-state">
        <i class="fas fa-tshirt"></i>
        <h3>No Cloth Types Found</h3>
        <p>No cloth types match your search criteria. Try adjusting your filters or add a new cloth type.</p>
        <a href="{% url 'inventory:cloth_create' %}"
           class="btn btn-primary"
           id="addFirstClothTypeBtn">
          <i class="fas fa-plus"></i>
          Add First Cloth Type
        </a>
      </div>
    {% endif %}
  </div>
{% endblock content %}
{% block extra_js %}
  <script>
    // Search and filter functionality
    document.addEventListener('DOMContentLoaded', function () {
      const searchInput = document.getElementById('searchInput')
      const sortSelect = document.getElementById('sortSelect')
      const searchForm = document.getElementById('searchForm')
    
      // Auto-submit form on filter change
      sortSelect.addEventListener('change', function () {
        searchForm.submit()
      })
    
      // Debounced search
      let searchTimeout
      searchInput.addEventListener('input', function () {
        clearTimeout(searchTimeout)
        searchTimeout = setTimeout(function () {
          searchForm.submit()
        }, 500)
      })
    })
  </script>
{% endblock extra_js %}
